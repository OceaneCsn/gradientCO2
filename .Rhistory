formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N_nutrition), color=N_nutrition),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(aes(group=interaction(CO2, N_nutrition)),
binaxis='y', stackdir='center', dotsize = 0.35)+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("C%") +
ggtitle("C% of plants under CO2 gradient and 2 types of N nutrition")+
xlim(c(390, 910)) +
labs(subtitle = "Spline interpolation, N=11 or 12 per CO2*N condition")
data %>%
lm(formula=C ~ ns(CO2, df=DF)*N_nutrition)%>%
summary()
data %>%
ggplot(aes(x=CO2, y=N/C, color=N_nutrition, fill=N_nutrition))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N_nutrition), color=N_nutrition),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(aes(group=interaction(CO2, N_nutrition)),
binaxis='y', stackdir='center', dotsize = 0.35)+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("N/C") +
ggtitle("N/C of plants under CO2 gradient and 2 types of N nutrition")+
xlim(c(390, 910)) +
labs(subtitle = "Spline interpolation, N=11 or 12 per CO2*N condition")
data %>%
lm(formula=N/C ~ ns(CO2, df=DF)*N_nutrition)%>%
summary()
data %>%
ggplot(aes(x=C, y=N, color=CO2, shape=N_nutrition)) +
geom_point()
data %>%
ggplot(aes(x=C, y=N, color=N_nutrition)) +
geom_point()
read.csv("../data/OC_08_dry_biomass.csv", sep=';') %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(data by="Tube") %>%
read.csv("../data/OC_08_dry_biomass.csv", sep=';') %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(data, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)
biomass <- read.csv("../data/OC_08_dry_biomass.csv", sep=';') %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(data, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
ggplot(aes(x=Dry_mass_mg, y = N)) +
geom_point()
read.csv("../data/OC_08_dry_biomass.csv", sep=';') %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(data, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
ggplot(aes(x=Dry_mass_mg, y = N)) +
geom_point()
read.csv("../data/OC_08_dry_biomass.csv", sep=';') %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(data, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
ggplot(aes(x=Dry_mass_mg, y = N)) +
geom_point(aes(size=CO2))
read.csv("../data/OC_08_dry_biomass.csv", sep=';') %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(data, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
ggplot(aes(x=Dry_mass_mg, y = N)) +
geom_point(aes(size=CO2, color=N_nutrition))
read.csv("../data/OC_08_dry_biomass.csv", sep=';') %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(data, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
ggplot(aes(x=Dry_mass_mg, y = N)) +
geom_point(aes(size=CO2, color=N_nutrition))+
stat_cor()
read.csv("../data/OC_08_dry_biomass.csv", sep=';') %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(data, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
ggplot(aes(x=Dry_mass_mg, y = N)) +
geom_point(aes(size=CO2, color=N_nutrition))+
stat_cor() + geom_smooth(method = 'lm')
read.csv("../data/OC_08_dry_biomass.csv", sep=';') %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(data, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
ggplot(aes(x=Dry_mass_mg, y = C)) +
geom_point(aes(size=CO2, color=N_nutrition))+
stat_cor() + geom_smooth(method = 'lm')
read.csv("../data/OC_08_dry_biomass.csv", sep=';') %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(data, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
ggplot(aes(x=Dry_mass_mg, y = C)) +
geom_point(aes(size=CO2, color=N_nutrition))+
stat_cor() + geom_smooth(method = 'lm', color='black')
read.csv("../data/OC_08_dry_biomass.csv", sep=';') %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(data, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
ggplot(aes(x=Dry_mass_mg, y = C)) +
geom_point(aes(size=CO2, color=N_nutrition))+
stat_cor() + geom_smooth(method = 'lm', color='black', alpha=0.1)
read.csv("../data/OC_08_dry_biomass.csv", sep=';') %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(data, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
ggplot(aes(x=Dry_mass_mg, y = N, label=CO2)) +
geom_point(aes(size=CO2, color=N_nutrition))+
stat_cor() + geom_smooth(method = 'lm', color='black', alpha=0.1) +
scale_color_brewer(palette = "Accent")+
geom_text()
read.csv("../data/OC_08_dry_biomass.csv", sep=';') %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(data, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
ggplot(aes(x=Dry_mass_mg, y = N, label=CO2)) +
geom_point(aes(size=CO2, color=N_nutrition))+
stat_cor() + geom_smooth(method = 'lm', color='black', alpha=0.1) +
scale_color_brewer(palette = "Accent")+
geom_text(size=1)
read.csv("../data/OC_08_dry_biomass.csv", sep=';') %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(data, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
ggplot(aes(x=Dry_mass_mg, y = N, label=CO2)) +
geom_point(aes(size=CO2, color=N_nutrition))+
stat_cor() + geom_smooth(method = 'lm', color='black', alpha=0.1) +
scale_color_brewer(palette = "Accent")+
geom_text(size=2)
read.csv("../data/OC_08_dry_biomass.csv", sep=';') %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(data, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
ggplot(aes(x=Dry_mass_mg, y = C, label=CO2)) +
geom_point(aes(size=CO2, color=N_nutrition))+
stat_cor() + geom_smooth(method = 'lm', color='black', alpha=0.1) +
scale_color_brewer(palette = "Accent")+
geom_text(size=2, color="grey")
read.csv("../data/OC_08_dry_biomass.csv", sep=';') %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(data, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
ggplot(aes(x=Dry_mass_mg, y = C, label=CO2)) +
geom_point(aes(size=CO2, color=N_nutrition))+
stat_cor() + geom_smooth(method = 'lm', color='black', alpha=0.1) +
scale_color_brewer(palette = "Accent")+
geom_text(size=2, color="white")
data %>%
ggplot(aes(x=C, y=N, label=CO2)) +
geom_point(aes(size=CO2, color=N_nutrition)) +
scale_color_brewer(palette = "Accent")+
geom_text(size=2)
data %>%
lm(formula=N/C ~ ns(CO2, df=2)*N_nutrition)%>%
AIC()
data %>%
lm(formula=N/C ~ ns(CO2, df=3)*N_nutrition)%>%
AIC()
data %>%
lm(formula=N/C ~ ns(CO2, df=4)*N_nutrition)%>%
AIC()
data %>%
lm(formula=N/C ~ ns(CO2, df=5)*N_nutrition)%>%
AIC()
data %>%
lm(formula=N/C ~ ns(CO2, df=6)*N_nutrition)%>%
AIC()
4
data %>%
lm(formula=N/C ~ ns(CO2, df=4)*N_nutrition)%>%
AIC()
data %>%
lm(formula=N/C ~ ns(CO2, df=4)*N_nutrition)%>%
BIC()
data %>%
lm(formula=N/C ~ ns(CO2, df=3)*N_nutrition)%>%
BIC()
data %>%
lm(formula=N/C ~ ns(CO2, df=3)*N_nutrition)%>%
BIC()
data %>%
lm(formula=N/C ~ ns(CO2, df=4)*N_nutrition)%>%
BIC()
data <- read.table(paste0('quantif_files/', 241, '.txt'), row.names ="V1")
colnames(data) = "241"
for(sample in 242:280){
df <- read.table(paste0('quantif_files/', sample, '.txt'), row.names ="V1")
colnames(df) <- as.character(sample)
data <- cbind.data.frame(data, df)
}
data <- read.csv(header = TRUE, row.names = "Gene", file = 'data/OC_08_raw_expression.txt',
check.names = F)
data <- data[!str_detect(row.names(data), '__'),]
library(tidyverse)
data <- data[!str_detect(row.names(data), '__'),]
annot <- read.csv('data/OC_08_annotation.csv', sep=';') %>%
filter(Tube > 240) %>%
mutate(label = paste(CO2,N, sep = '.')) %>%
mutate(label = paste0(label, '_', rep(1:4, 10))) %>%
select(Tube, label)
colnames(data) <- annot[match(colnames(data), annot$Tube), "label"]
data <- data[order(colnames(data))]
data <- data[rowSums(data) >40,]
corplot(data)
library(corrplot)
corrplot(data, method = 'color', order = 'alphabet')
var(data)
cor(data)
corrplot(cor(data), method = 'color', order = 'alphabet')
data <- read.csv(header = TRUE, row.names = "Gene", file = 'data/OC_08_raw_expression.txt',
check.names = F)
data <- data[!str_detect(row.names(data), '__'),]
annot <- read.csv('data/OC_08_annotation.csv', sep=';') %>%
filter(Tube > 240) %>%
mutate(label = paste(N,CO2, sep = '.')) %>%
mutate(label = paste0(label, '_', rep(1:4, 10))) %>%
select(Tube, label)
colnames(data) <- annot[match(colnames(data), annot$Tube), "label"]
data <- data[order(colnames(data))]
corrplot(cor(data), method = 'color', order = 'alphabet')
library(DIANE)
data("abiotic_stresses")
corrplot(cor(abiotic_stresses$normalized_counts), method = 'color', order = 'alphabet')
corrplot(cor(data), method = 'color', order = 'alphabet')
corrplot(cor(data), method = 'color', order = 'hclust')
corrplot(cor(data), method = 'color', order = 'FPC')
install.packages("ssclust")
corrplot(cor(data), method = 'color', order = 'alphabet')
data <- read.table(paste0('quantif_files/', 241, '.txt'), row.names ="V1")
colnames(data) = "241"
for(sample in 242:280){
df <- read.table(paste0('quantif_files/', sample, '.txt'), row.names ="V1")
colnames(df) <- as.character(sample)
data <- cbind.data.frame(data, df)
}
data <- read.csv(header = TRUE, row.names = "Gene", file = 'data/OC_08_raw_expression.txt',
check.names = F)
data <- data[!str_detect(row.names(data), '__'),]
corrplot(cor(data), method = 'color', order = 'alphabet')
corrplot(cor(data), method = 'color', order = 'FPC')
install.packages("scclust")
data <- read.csv(header = TRUE, row.names = "Gene", file = 'data/OC_08_raw_expression.txt',
check.names = F)
data <- data[!str_detect(row.names(data), '__'),]
annot <- read.csv('data/OC_08_annotation.csv', sep=';') %>%
filter(Tube > 240) %>%
mutate(label = paste(N,CO2, sep = '.')) %>%
mutate(label = paste0(label, '_', rep(1:4, 10))) %>%
select(Tube, label)
colnames(data) <- annot[match(colnames(data), annot$Tube), "label"]
data <- data[order(colnames(data))]
corrplot(cor(data), method = 'color', order = 'alphabet')
corrplot(cor(data), method = 'color', order = 'alphabet', type = "lower")
corrplot(cor(data), method = 'color', order = 'alphabet', type = "lower", col.lim = c(0,1))
corrplot(cor(data), method = 'color', order = 'alphabet', type = "lower", col.lim = c(0,1), addrect = T)
corrplot(cor(data), method = 'color', order = 'hclust', type = "lower", col.lim = c(0,1), addrect = T)
corrplot(cor(data), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
corrplot(cor(abiotic_stresses$normalized_counts), method = 'color', order = 'hclust')
corrplot(cor(data), method = 'color', order = 'hclust', type = "lower", col.lim = c(0,1), addrect = T)
corrplot(cor(data), method = 'color', order = 'hclust', col.lim = c(0,1), addrect = T)
corrplot(cor(data), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
d <- data
corrplot(cor(data), method = 'color', order = 'hclust', col.lim = c(0,1), addrect = T)
corrplot(cor(data), method = 'color', order = 'hclust', col.lim = c(0,1), addrect = T)
corrplot(cor(data), method = 'color', order = 'FPC')
corrplot(cor(data), method = 'color', order = "AOE", col.lim = c(0,1), addrect = T)
View(annot)
data <- read.csv(header = TRUE, row.names = "Gene", file = 'data/OC_08_raw_expression.txt',
check.names = F)
data <- data[!str_detect(row.names(data), '__'),]
corrplot(cor(data), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
corrplot(cor(abiotic_stresses$normalized_counts), method = 'color', order = 'alphabet')
corrplot(cor(log(data+1)), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
corrplot(cor(log(data+1), method = "spearman"), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
corrplot(cor(data, method = "spearman"), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
corrplot(cor(data), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
data <- data[rowSums(data) >400,]
corrplot(cor(data), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
data <- data[rowSums(data) >4000,]
corrplot(cor(data), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
annot <- read.csv('data/OC_08_annotation.csv', sep=';') %>%
filter(Tube > 240) %>%
mutate(label = paste(N,CO2, sep = '.')) %>%
mutate(label = paste0(label, '_', rep(1:4, 10))) %>%
select(Tube, label)
colnames(data) <- annot[match(colnames(data), annot$Tube), "label"]
data <- data[order(colnames(data))]
data <- read.csv(header = TRUE, row.names = "Gene", file = 'data/OC_08_raw_expression.txt',
check.names = F)
data <- data[!str_detect(row.names(data), '__'),]
corrplot(cor(data), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
annot <- read.csv('data/OC_08_annotation.csv', sep=';') %>%
filter(Tube > 240) %>%
mutate(label = paste(N,CO2, sep = '.')) %>%
mutate(label = paste0(label, '_', rep(1:4, 10))) %>%
select(Tube, label)
colnames(data) <- annot[match(colnames(data), annot$Tube), "label"]
data <- data[order(colnames(data))]
data <- data[rowSums(data) >4000,]
corrplot(cor(data), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
annot <- read.csv('data/OC_08_annotation.csv', sep=';') %>%
filter(Tube > 240) %>%
mutate(label = paste(CO2,N, sep = '.')) %>%
mutate(label = paste0(label, '_', rep(1:4, 10))) %>%
select(Tube, label)
colnames(data) <- annot[match(colnames(data), annot$Tube), "label"]
data <- data[order(colnames(data))]
save(data, file = "rdata/expression_data.rdata")
corrplot(cor(data), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
data <- read.csv(header = TRUE, row.names = "Gene", file = 'data/OC_08_raw_expression.txt',
check.names = F)
data <- data[!str_detect(row.names(data), '__'),]
corrplot(cor(data), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
annot <- read.csv('data/OC_08_annotation.csv', sep=';') %>%
filter(Tube > 240) %>%
mutate(label = paste(CO2,N, sep = '.')) %>%
mutate(label = paste0(label, '_', rep(1:4, 10))) %>%
select(Tube, label)
colnames(data) <- annot[match(colnames(data), annot$Tube), "label"]
data <- data[order(colnames(data))]
corrplot(cor(data), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
dc <- read.csv(header = TRUE, row.names = "Gene", file = 'data/correction_OC_08_CO2_gradient_KNO3_Mix_Ecotron.csv',
check.names = F)
View(dc)
corrplot(cor(dc), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
dc <- read.csv(header = TRUE, row.names = "Gene", file = 'data/correction_OC_08_CO2_gradient_KNO3_Mix_Ecotron.csv',
check.names = F)
corrplot(cor(dc), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
n <- colnames(data)
colnames(data) %>%
str_replace("400.KNO3_3", "tmp") %>%
str_replace("900.Mix_3", "400.KNO3_3") %>%
str_replace("tmp", "900.Mix_3") %>%
str_replace("400.KNO3_4", "tmp") %>%
str_replace("900.Mix_4", "400.KNO3_4") %>%
str_replace("tmp", "900.Mix_4") %>%
str_replace("400.Mix_1", "tmp") %>%
str_replace("775.Mix_3", "400.Mix_1") %>%
str_replace("tmp", "775.Mix_3") %>%
str_replace("900.KNO3_4", "tmp") %>%
str_replace("775.Mix_4", "900.KNO3_4") %>%
str_replace("tmp", "775.Mix_4")
dc2 <- data
colnames(dc2) <- colnames(data) %>%
str_replace("400.KNO3_3", "tmp") %>%
str_replace("900.Mix_3", "400.KNO3_3") %>%
str_replace("tmp", "900.Mix_3") %>%
str_replace("400.KNO3_4", "tmp") %>%
str_replace("900.Mix_4", "400.KNO3_4") %>%
str_replace("tmp", "900.Mix_4") %>%
str_replace("400.Mix_1", "tmp") %>%
str_replace("775.Mix_3", "400.Mix_1") %>%
str_replace("tmp", "775.Mix_3") %>%
str_replace("900.KNO3_4", "tmp") %>%
str_replace("775.Mix_4", "900.KNO3_4") %>%
str_replace("tmp", "775.Mix_4")
corrplot(cor(dc), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
corrplot(cor(dc2), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
data <- read.csv(header = TRUE, row.names = "Gene", file = 'data/OC_08_raw_expression.txt',
check.names = F)
data <- data[!str_detect(row.names(data), '__'),]
corrplot(cor(data), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
annot <- read.csv('data/OC_08_annotation.csv', sep=';') %>%
filter(Tube > 240) %>%
mutate(label = paste(CO2,N, sep = '.')) %>%
mutate(label = paste0(label, '_', rep(1:4, 10))) %>%
select(Tube, label)
colnames(data) <- annot[match(colnames(data), annot$Tube), "label"]
data <- data[order(colnames(data))]
dc2 <- data
colnames(dc2) <- colnames(data) %>%
str_replace("400.KNO3_3", "tmp") %>%
str_replace("900.Mix_3", "400.KNO3_3") %>%
str_replace("tmp", "900.Mix_3") %>%
str_replace("400.KNO3_4", "tmp") %>%
str_replace("900.Mix_4", "400.KNO3_4") %>%
str_replace("tmp", "900.Mix_4") %>%
str_replace("400.Mix_1", "tmp") %>%
str_replace("775.Mix_3", "400.Mix_1") %>%
str_replace("tmp", "775.Mix_3") %>%
str_replace("900.KNO3_4", "tmp") %>%
str_replace("775.Mix_4", "900.KNO3_4") %>%
str_replace("tmp", "775.Mix_4")
corrplot(cor(dc2), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
write.table(dc, file = "data/OC_08_CO2_gradient_KNO3_Mix_Ecotron_corrected_for_mismatch.csv", sep = ',', quote = F)
corrplot(cor(dc2), method = 'color', order = 'hclust', col.lim = c(0,1), addrect = T)
data <- read.csv(header = TRUE, row.names = "Gene", file = 'data/OC_08_raw_expression.txt',
check.names = F)
data <- data[!str_detect(row.names(data), '__'),]
corrplot(cor(data), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
annot <- read.csv('data/OC_08_annotation.csv', sep=';') %>%
filter(Tube > 240) %>%
mutate(label = paste(CO2,N, sep = '.')) %>%
mutate(label = paste0(label, '_', rep(1:4, 10))) %>%
select(Tube, label)
colnames(data) <- annot[match(colnames(data), annot$Tube), "label"]
data <- data[order(colnames(data))]
dc2 <- data
colnames(dc2) <- colnames(data) %>%
str_replace("400.KNO3_3", "tmp") %>%
str_replace("900.Mix_3", "400.KNO3_3") %>%
str_replace("tmp", "900.Mix_3") %>%
str_replace("400.KNO3_4", "tmp") %>%
str_replace("900.Mix_4", "400.KNO3_4") %>%
str_replace("tmp", "900.Mix_4") %>%
str_replace("400.Mix_1", "tmp") %>%
str_replace("775.Mix_3", "400.Mix_1") %>%
str_replace("tmp", "775.Mix_3") %>%
str_replace("900.KNO3_4", "tmp") %>%
str_replace("775.Mix_4", "900.KNO3_4") %>%
str_replace("tmp", "775.Mix_4")
write.table(dc2, file = "data/OC_08_CO2_gradient_KNO3_Mix_Ecotron_corrected_for_mismatch.csv", sep = ',', quote = F)
write.table(dc2, file = "data/OC_08_CO2_gradient_KNO3_Mix_Ecotron_corrected_for_mismatch.csv", sep = ',', quote = F)
write.table(dc2, file = "data/OC_08_CO2_gradient_KNO3_Mix_Ecotron_corrected_for_mismatch.csv", sep = ',', quote = F)
write.table(dc2, file = "data/OC_08_CO2_gradient_KNO3_Mix_Ecotron_corrected_for_mismatch.csv", sep = ',', quote = F)
colnames(dc2) <- colnames(dc2) %>%
str_replace("775.KNO3_2", "tmp") %>%
str_replace("400.Mix_1", "775.KNO3_2") %>%
str_replace("tmp", "400.Mix_1")%>%
str_replace("775.KNO3_4", "tmp") %>%
str_replace("400.Mix_2", "775.KNO3_4") %>%
str_replace("tmp", "400.Mix_2")%>%
str_replace("900.KNO3_4", "tmp") %>%
str_replace("400.Mix_4", "900.KNO3_4") %>%
str_replace("tmp", "400.Mix_4")
corrplot(cor(dc2), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
write.table(dc2, file = "data/OC_08_CO2_gradient_KNO3_Mix_Ecotron_corrected_for_mismatch.csv", sep = ',', quote = F)
write.table(dc2, file = "data/OC_08_CO2_gradient_KNO3_Mix_Ecotron_corrected_for_mismatch.csv", sep = ',', quote = F)
dc2 <- data
colnames(dc2) <- colnames(data) %>%
str_replace("400.KNO3_3", "tmp") %>%
str_replace("900.Mix_3", "400.KNO3_3") %>%
str_replace("tmp", "900.Mix_3") %>%
str_replace("400.KNO3_4", "tmp") %>%
str_replace("900.Mix_4", "400.KNO3_4") %>%
str_replace("tmp", "900.Mix_4") %>%
str_replace("400.Mix_1", "tmp") %>%
str_replace("775.Mix_3", "400.Mix_1") %>%
str_replace("tmp", "775.Mix_3") %>%
str_replace("900.KNO3_4", "tmp") %>%
str_replace("775.Mix_4", "900.KNO3_4") %>%
str_replace("tmp", "775.Mix_4")
colnames(dc2) <- colnames(dc2) %>%
str_replace("775.KNO3_2", "tmp") %>%
str_replace("400.Mix_1", "775.KNO3_2") %>%
str_replace("tmp", "400.Mix_1")%>%
str_replace("775.KNO3_4", "tmp") %>%
str_replace("400.Mix_2", "775.KNO3_4") %>%
str_replace("tmp", "400.Mix_2")%>%
str_replace("900.KNO3_4", "tmp") %>%
str_replace("400.Mix_4", "900.KNO3_4") %>%
str_replace("tmp", "400.Mix_4")%>%
str_replace("775.KNO3_4", "tmp") %>%
str_replace("400.Mix_3", "775.KNO3_4") %>%
str_replace("tmp", "400.Mix_3")
corrplot(cor(dc2), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
write.table(dc2, file = "data/OC_08_CO2_gradient_KNO3_Mix_Ecotron_corrected_for_mismatch.csv", sep = ',', quote = F)
corrplot(cor(dc2), method = 'color', order = 'hclust', col.lim = c(0,1), addrect = T)
corrplot(cor(dc2), method = 'color', order = 'alphabet', col.lim = c(0,1), addrect = T)
data <- dc2
save(data, file = "rdata/expression_data_no_mismatch.rdata")
View(data)
