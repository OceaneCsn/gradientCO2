ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 N nutritions")
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)%>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=0.8, width=20, fill="white", outlier.alpha = 0)+
geom_point()+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 N nutritions")
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)%>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_point()+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 N nutritions")
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)%>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(binaxis='y', stackdir='center')+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 N nutritions")
geom_dotplot(aes(group=interaction(CO2, N),binaxis='y', stackdir='center')+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)%>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(aes(group=interaction(CO2, N)),,binaxis='y', stackdir='center')+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 N nutritions")
data %>%
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)%>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(aes(group=interaction(CO2, N)),binaxis='y', stackdir='center')+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 N nutritions")
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)%>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(aes(group=interaction(CO2, N)),
binaxis='y', stackdir='center', dotsize = 1)+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 N nutritions")
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)%>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(aes(group=interaction(CO2, N)),
binaxis='y', stackdir='center', dotsize = 0.5)+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 N nutritions")
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)%>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(aes(group=interaction(CO2, N)),
binaxis='y', stackdir='center', dotsize = 0.5)+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 types of N nutrition")
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)%>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(aes(group=interaction(CO2, N)),
binaxis='y', stackdir='center', dotsize = 0.25)+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 types of N nutrition")
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)%>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(aes(group=interaction(CO2, N)),
binaxis='y', stackdir='center', dotsize = 0.35)+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 types of N nutrition")
DF=4
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)%>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(aes(group=interaction(CO2, N)),
binaxis='y', stackdir='center', dotsize = 0.35)+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 types of N nutrition")
DF=3
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)%>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(aes(group=interaction(CO2, N)),
binaxis='y', stackdir='center', dotsize = 0.35)+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 types of N nutrition")
DF=2
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)%>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(aes(group=interaction(CO2, N)),
binaxis='y', stackdir='center', dotsize = 0.35)+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 types of N nutrition")
DF=1
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)%>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(aes(group=interaction(CO2, N)),
binaxis='y', stackdir='center', dotsize = 0.35)+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 types of N nutrition")
DF=2
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)%>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(aes(group=interaction(CO2, N)),
binaxis='y', stackdir='center', dotsize = 0.35)+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 types of N nutrition")
DF=3
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)%>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(aes(group=interaction(CO2, N)),
binaxis='y', stackdir='center', dotsize = 0.35)+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 types of N nutrition")
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
lm(Dry_mass_mg ~ ns(CO2, df=DF)*N)%>%
summary()
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
lm(formula=Dry_mass_mg ~ ns(CO2, df=DF)*N)%>%
summary()
DF=2
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
lm(formula=Dry_mass_mg ~ ns(CO2, df=DF)*N)%>%
summary()
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
lm(formula=Dry_mass_mg ~ ns(CO2, df=DF)*N)%>%
summary() %>%
prettify()
library(jsonlite)
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
lm(formula=Dry_mass_mg ~ ns(CO2, df=DF)*N)%>%
summary() %>%
prettify()
ns(CO2, df=DF
ns(CO2, df=DF)
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
mutate(ns(CO2, df = DF))
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
mutate(ns(CO2, df = DF))
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
mutate(ns(CO2, df = DF))
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
mutate(n1, n2 =ns(CO2, df = DF))
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
lm(formula=Dry_mass_mg ~ ns(CO2, df=DF)*N)%>%
summary() %>%
prettify()
data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0) %>%
lm(formula=Dry_mass_mg ~ ns(CO2, df=DF)*N)%>%
summary()
d <- data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE )
library(tidyverse)
library(splines)
library(ggpubr)
library(jsonlite)
data <- read.csv("../data/OC_08_dry_biomass.csv", sep=';')
annot <- read.csv("../data/OC_08_annotation.csv", sep=';')
DF=2
data <- data %>%
filter(!str_detect(TubeVide, "Date")) %>%
mutate(Dry_mass_mg = (parse_number(Tube_masse_seche)- parse_number(TubeVide))*1000) %>%
select(Tube, Dry_mass_mg) %>%
inner_join(annot, by="Tube") %>%
select(-c(Tissue, RNA)) %>%
filter(Dry_mass_mg >0)
data %>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(aes(group=interaction(CO2, N)),
binaxis='y', stackdir='center', dotsize = 0.35)+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 types of N nutrition")
data %>%
lm(formula=Dry_mass_mg ~ ns(CO2, df=DF)*N)%>%
summary()
ns(data$CO2)
ns(data$CO2, df=DF)
splines <- ns(data$CO2, df=DF)
splines <- data.frame(ns(data$CO2, df=DF))
data.frame(ns(data$CO2, df=DF))
data.frame(ns(data$CO2, df=DF)) %>%
gather(key="DF", value = "Value", X1, X2)
data.frame(ns(data$CO2, df=DF))
data.frame(ns(data$CO2, df=DF)) %>%
mutate(CO2 = data$CO2) %>%
gather(key="DF", value = "Value", X1, X2)
ggplot(aes(x=CO2, y=Value, color=DF))
data.frame(ns(data$CO2, df=DF)) %>%
mutate(CO2 = data$CO2) %>%
gather(key="DF", value = "Value", X1, X2) %>%
ggplot(aes(x=CO2, y=Value, color=DF))+
geom_point()
data.frame(ns(data$CO2, df=DF)) %>%
mutate(CO2 = data$CO2) %>%
gather(key="DF", value = "Value", X1, X2) %>%
ggplot(aes(x=CO2, y=Value, color=DF))+
geom_point() + geom_smooth()
data.frame(ns(data$CO2, df=DF)) %>%
mutate(CO2 = data$CO2) %>%
gather(key="DF", value = "Value", contains("X")) %>%
ggplot(aes(x=CO2, y=Value, color=DF))+
geom_point() + geom_smooth()
data %>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(aes(group=interaction(CO2, N)),
binaxis='y', stackdir='center', dotsize = 0.35)+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 types of N nutrition")+xlim(c(390, 910))
data %>%
ggplot(aes(x=CO2, y=Dry_mass_mg, color=N, fill=N))+
geom_smooth(method = "lm", se = T, size = 1, alpha=0.3,
formula = y ~ ns(x, df=DF))+
geom_boxplot(aes(group=interaction(CO2, N), color=N),
alpha=1, width=20, fill="white", outlier.alpha = 0)+
geom_dotplot(aes(group=interaction(CO2, N)),
binaxis='y', stackdir='center', dotsize = 0.35)+
theme_pubr() +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
ylab("Dry biomass (mg)") +
ggtitle("Dry biomass of plants under CO2 gradient and 2 types of N nutrition")+
xlim(c(390, 910)) +
labs(subtitle = "Spline interpolation, N=11 or 12 per CO2*N condition")
